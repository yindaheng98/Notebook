# å¯å¾®çŸ¢é‡é‡åŒ–

å‰ç½®çŸ¥è¯†ï¼š[ã€Šä¸€äº›å¸¸è§çš„æ¨¡å‹é‡åŒ–æ–¹æ³•ã€‹](../äººå·¥æ™ºèƒ½/quant.md)

## (SIGGRAPH'22) Variable Bitrate Neural Fields (Vector-Quantized Auto-Decoder, VQ-AD)

![](i/20240423163529.png)

è¿™è®ºæ–‡æŠŠçŸ¢é‡é‡åŒ–çš„æ€æƒ³ç”¨åˆ°Feature Gridçš„è®­ç»ƒå’Œå­˜å‚¨ä¸­ï¼Œä»è€Œå‹ç¼©æ¨¡å‹çš„å¤§å°ã€‚
å…·ä½“æ¥è¯´ï¼Œæœ¬æ–‡çš„æ–¹æ³•æ˜¯æŠŠInstantNGPä¸­ä½¿ç”¨ç©ºé—´hashå‡½æ•°æŸ¥è¡¨çš„æ–¹æ³•æ”¹æˆäº†ä¸€ä¸ªå¯è®­ç»ƒçš„indicesã€‚

å‰ç½®çŸ¥è¯†ï¼šInstantNGP
* [ã€Šä½“æ¸²æŸ“ã€ä½“ç´ ã€ä½ç½®ç¼–ç â€”â€”ä¸»æµNerfè´¨é‡ä¼˜åŒ–å’Œè®¡ç®—åŠ é€Ÿæ–¹æ³•å­¦ä¹ ã€‹](./NerfåŠ é€Ÿ.md)
* [ã€Šã€è½¬è½½ã€‘NeRFç³»åˆ—å·¥ä½œæ€»ç»“ã€‹](./NeRFç³»åˆ—å·¥ä½œæ€»ç»“.md)

åœ¨InstantNGPä¸­ï¼Œhashè¡¨çš„valueså¯ä»¥è§†ä¸ºçŸ¢é‡é‡åŒ–ä¸­çš„ç çŸ¢ï¼Œè®­ç»ƒè¿‡ç¨‹å®é™…ä¸Šå°±æ˜¯åœ¨å¯¹è¿™ä¸ªç çŸ¢è¿›è¡Œè®­ç»ƒã€‚
ç…§è¿™ä¸ªæ€è·¯ï¼ŒInstantNGPä¸­codebookçš„keyå°±æ˜¯ç”±ç©ºé—´hashå‡½æ•°ç”Ÿæˆçš„å€¼ã€‚
ä½†æ˜¯ï¼ŒçŸ¢é‡é‡åŒ–çš„ä¸€ä¸ªå¾ˆé‡è¦çš„æ€æƒ³å°±æ˜¯è¦å¯¹è¾“å…¥å‘é‡è¿›è¡Œèšç±»ï¼Œä¿è¯è¾“å…¥å‘é‡å’Œå…¶å¯¹åº”çš„ç çŸ¢å°½å¯èƒ½æ¥è¿‘ï¼Œè€ŒInstantNGPä¸­featureå€¼ç›¸è¿‘çš„regionï¼ˆå†…å®¹ç›¸ä¼¼çš„åŒºåŸŸï¼‰ç»è¿‡ç©ºé—´hashå‡ºæ¥çš„å€¼éšæœºå‡åŒ€åˆ†å¸ƒåœ¨æŒ‡å®šèŒƒå›´å†…ï¼Œäºæ˜¯ç›¸è¿‘çš„è¾“å…¥å‘é‡å¹¶ä¸ä¸€å®šä¼šå¯¹åº”åˆ°åŒä¸€ä¸ªç çŸ¢ã€‚

æ‰€ä»¥è¿™æ ·å…¶å®å¹¶ä¸ç¬¦åˆçŸ¢é‡é‡åŒ–çš„æ€æƒ³ï¼ŒçŸ¢é‡é‡åŒ–é€šå¸¸ç”¨èšç±»ç­‰æ–¹æ³•è®©è¾“å…¥å‘é‡å’Œå…¶å¯¹åº”çš„ç çŸ¢å°½å¯èƒ½æ¥è¿‘ï¼Œåœ¨InstantNGPçš„åœºæ™¯å°±æ˜¯å†…å®¹ç›¸ä¼¼çš„åŒºåŸŸå¯¹åº”åˆ°åŒä¸€ä¸ªç çŸ¢ã€‚
æœ¬æ–‡å°±æ˜¯è¦è§£å†³è¿™ä¸ªé—®é¢˜ã€‚

### å…·ä½“æ“ä½œ

ç¬¦å·|å«ä¹‰
-|-
$D\in\mathbb R^{2^b\times k}$|å­˜å‚¨$2^b$ä¸ª$k$ç»´featureçš„codebook
$m$|ç©ºé—´ç­‰åˆ†ä¸ºgridï¼Œgridæ¯ä¸ªé¡¶ç‚¹éƒ½å¯¹åº”ä¸€ä¸ªfeatureï¼Œfeatureæ•°é‡å…±$m$ä¸ª
$V\in\mathbb Z^m$ï¼Œå–å€¼èŒƒå›´$[0,2^b-1]$|gridçš„$m$ä¸ªé¡¶ç‚¹å¯¹åº”çš„featureåœ¨codebookä¸­çš„ä½ç½®
$C\in\mathbb R^{m\times 2^b}$|softened indicesçŸ©é˜µï¼Œgridçš„$m$ä¸ªé¡¶ç‚¹éƒ½èƒ½ä»å…¶ä¸­æŸ¥å‡ºä¸€ä¸ª$2^b$ç»´å‘é‡

### è®­ç»ƒè¿‡ç¨‹ä¸­çš„forward

1. ï¼ˆåŒInstantNGPï¼‰å¯¹äºæ¯ä¸ªè¾“å…¥åæ ‡ï¼Œè®¡ç®—å…¶åœ¨gridé‡Œçš„é‚£ä¸ªcubeä¸­ï¼Œç®—å‡ºcubeçš„8ä¸ªé¡¶ç‚¹ç¼–å·
2. å¯¹äºæ¯ä¸ªé¡¶ç‚¹ï¼Œåœ¨$C$ä¸­æŸ¥å‡º$2^b$ç»´å‘é‡ï¼Œç»è¿‡ä¸€ä¸ªsoftmaxæ¿€æ´»å‡½æ•°
3. æŠŠè¿™ä¸ª$2^b$ç»´å‘é‡ä¸$D$ä¸­çš„$2^b$ä¸ª$k$ç»´featureä¾æ¬¡ç›¸ä¹˜åæ±‚å’Œï¼Œä½œä¸ºè¿™ä¸ªé¡¶ç‚¹çš„feature
4. ï¼ˆåŒInstantNGPï¼‰æ’å€¼ã€è¿‡MLPã€æ¸²æŸ“

è¿™æ ·ï¼Œç”¨å¯è®­ç»ƒçš„softened indicesçŸ©é˜µ$C$ä»£æ›¿æ²¡æ³•è®­ç»ƒçš„hashå‡½æ•°indicesï¼Œé—´æ¥è¾¾åˆ°èšç±»çš„æ•ˆæœã€‚

### è®­ç»ƒç»“æŸåçš„æ•°æ®è½¬æ¢

softened indicesçŸ©é˜µ$C$å¾ˆå¤§ï¼Œæ˜¾ç„¶ä¸èƒ½ç›´æ¥å­˜å®ƒï¼Œä½†æ˜¯åœ¨å‰é¢è®­ç»ƒçš„æ—¶å€™è®©å®ƒç»è¿‡ä¸€ä¸ªsoftmaxæ¿€æ´»å‡½æ•°å°±æ˜¯ä¸ºäº†è®©å®ƒé‡Œé¢çš„å€¼å˜æˆone-hotçš„ï¼Œäºæ˜¯ç›´æ¥$V=\text{argmax}_iC[i]$å°±æŠŠå®ƒè½¬åŒ–ä¸ºäº†ä¸€ä¸ª$m$ä¸ª$b$ bitæ•´æ•°çš„indexè¡¨ã€‚

### æ¨æ–­æ—¶çš„forward

1. ï¼ˆåŒInstantNGPï¼‰å¯¹äºæ¯ä¸ªè¾“å…¥åæ ‡ï¼Œè®¡ç®—å…¶åœ¨gridé‡Œçš„é‚£ä¸ªcubeä¸­ï¼Œç®—å‡ºcubeçš„8ä¸ªé¡¶ç‚¹ç¼–å·
2. å¯¹äºæ¯ä¸ªé¡¶ç‚¹ï¼Œåœ¨$V$ä¸­æŸ¥å‡º$b$ bitæ•´æ•°å³å…¶featureåœ¨featureè¡¨ä¸­$D$çš„ä½ç½®
3. æ ¹æ®è¿™ä¸ªä½ç½®ä»$D$ä¸­æ‰¾å‡ºè¿™ä¸ªé¡¶ç‚¹çš„feature
4. ï¼ˆåŒInstantNGPï¼‰æ’å€¼ã€è¿‡MLPã€æ¸²æŸ“

### å‹ç¼©æ•ˆæœ

åŸæ–‡ä¸­çš„æè¿°ï¼š

>In contrast to using a hash function [MÃ¼ller et al. 2022] for indexing, we need to store ğ‘-bit integers in the feature grid but we are able to use a much smaller codebook (table) due to the learned adaptivity of the indices.

æ¯”InstantNGPå¤šå­˜$m$ä¸ª$b$ bitæ•´æ•°ï¼Œç©ºé—´åˆ’åˆ†è¶Šç»†$m$è¶Šå¤§ã€‚

è¿™ç§æ–¹æ³•ç”¨å¯è®­ç»ƒçš„softened indicesé—´æ¥è¾¾åˆ°èšç±»çš„æ•ˆæœï¼Œæ‰€ä»¥åŒæ ·çš„codebooké•¿åº¦å…¶è´¨é‡è¦æ¯”ç”¨ç©ºé—´hashçš„InstantNGPæ›´å¥½ã€‚

![](i/20240423175518.png)

å®éªŒç»“æœå¯ä»¥çœ‹å‡ºï¼ŒVQ-ADä¸»è¦çš„å­˜å‚¨å ç”¨éƒ½æ˜¯é‚£$m$ä¸ª$b$ bitæ•´æ•°ï¼Œåå€’æ˜¯codebookæˆäº†å¤§å¤´ï¼Œä¸è¿‡æ•´ä½“ä¸Šè¿˜æ˜¯VQ-ADæ›´å°ã€‚